<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd">
	<sub-flow name="sys-business-central-api-create-dimension-subflow" doc:id="a321c5cf-03e3-4a61-be9c-ffde811df7bc" >
		<logger level="INFO" doc:name="START - Create Dimension" doc:id="eada82da-dc6b-41c7-96bf-550e41822a93" message="START - Create Dimension | Payload: #[payload]" category="${app.log.category}"/>
		<try doc:name="Try" doc:id="6f5dac43-e4cb-492a-bdc3-2a4190037413">
			<http:request method="POST" doc:name="POST /sys-business-central-api/dimension" doc:id="1f741914-5f91-4adb-8462-465b7f61d373" config-ref="HTTP_Request_configuration_sys-business-central-api" path="${sys.bc.path.dimension}" sendCorrelationId="ALWAYS">
			<error-mapping sourceType="HTTP:CONNECTIVITY" targetType="FS:CONNECTIVITY" />
				<http:headers><![CDATA[#[output application/java
---
{
	"client-id" : p('sys.bc.client.id'),
	"client-secret" : p('sys.bc.client.secret'),
	"Content-Type": "application/json",
	"company": p('sys.bc.company.header')
}]]]></http:headers>
		</http:request>
			<error-handler ref="system-error-handler" />
		</try>
		<logger level="INFO" doc:name="DEBUG - Create Dimension" doc:id="8f1954fe-c57f-478f-9bed-ac370be2ddc6" message="DEBUG - Create Dimension Response: #[payload]" category="${app.log.category}" />
		<logger level="INFO" doc:name="END - Create Dimension" doc:id="1ddac0b4-5fc4-461b-bc32-2192371363b6" category="${app.log.category}" message="END - Create Dimension | Success | System ID: #[payload.data.systemId]"/>
	</sub-flow>
	<sub-flow name="sys-business-central-api-get-dimension-subflow" doc:id="d7d95f39-5432-4d34-8718-6f8c1989e376" >
		<logger level="INFO" doc:name="START - Get Dimension" doc:id="24ff1703-aff8-4607-8414-83c7431a4be0" category="${app.log.category}" message="START - Get Dimension | Query Params: #[vars.bcQueryParams]"/>
		<until-successful maxRetries="${retry.attempt.max}" doc:name="Until Succesful" doc:id="3c4751c5-2268-4810-aebf-c3ab7734aca5" millisBetweenRetries="${retry.attempt.wait}">
		<try doc:name="Try" doc:id="0d6f4bc0-79fb-4db0-9031-c772a8f84e4c">
			<http:request method="GET" doc:name="GET /sys-business-central-api/dimension" doc:id="b48635ed-9687-46d9-9dcf-14f9792fa722" config-ref="HTTP_Request_configuration_sys-business-central-api" path="${sys.bc.path.dimension}" sendCorrelationId="ALWAYS">
			<error-mapping sourceType="HTTP:CONNECTIVITY" targetType="FS:CONNECTIVITY" />
			<http:headers><![CDATA[#[output application/java
---
{
	"client-id" : p('sys.bc.client.id'),
	"client-secret" : p('sys.bc.client.secret'),
	"Content-Type": "application/json",
	"company": p('sys.bc.company.header')
}]]]></http:headers>
					<http:query-params ><![CDATA[#[(vars.bcQueryParams)]]]></http:query-params>
		</http:request>
			<error-handler ref="system-error-handler" />
		</try>
		</until-successful>
		<logger level="INFO" doc:name="DEBUG - Get Dimension Result" doc:id="d64a0bc7-4855-4780-878a-9da7673eed14" message="DEBUG - Get Dimension Result : #[payload]" category="${app.log.category}" />
		<logger level="INFO" doc:name="END - Get Dimension" doc:id="73ad7272-0a91-4d34-92fb-443860964e2e" category="${app.log.category}" message="END - Get Dimension | Result Count: #[sizeOf(payload.data)]"/>
	</sub-flow>
	<sub-flow name="sys-business-central-api-update-dimension-subflow" doc:id="a7adf576-e63a-4926-a731-aae0e2ec0ab2" >
		<logger level="INFO" doc:name="START - Update Dimension" doc:id="faebbed2-6164-457f-96f6-72349ffae04e" message="START - Update Dimension | Payload: #[payload] | System ID: #[vars.uriParams]" category="${app.log.category}"/>
		<try doc:name="Try" doc:id="57f92e9f-ca1f-4c0a-abc8-3a00b7023415">
			<http:request method="PATCH" doc:name="PATCH /sys-business-central-api/dimension" doc:id="7c99f086-b0e3-49a8-8731-50e74b19b1a8" config-ref="HTTP_Request_configuration_sys-business-central-api" path="${sys.bc.path.dimension.update}" sendCorrelationId="ALWAYS">
			<error-mapping sourceType="HTTP:CONNECTIVITY" targetType="FS:CONNECTIVITY" />
			<http:headers><![CDATA[#[output application/java
---
{
	"client-id" : p('sys.bc.client.id'),
	"client-secret" : p('sys.bc.client.secret'),
	"Content-Type": "application/json",
	"company": p('sys.bc.company.header')
}]]]></http:headers>
				<http:uri-params ><![CDATA[#[vars.uriParams]]]></http:uri-params>
		</http:request>
			<error-handler ref="system-error-handler" />
		</try>
		<logger level="INFO" doc:name="DEBUG - Update Dimension" doc:id="f5ee808e-19c9-4053-a855-91f4d7e81a99" message="DEBUG - Update Dimension Response: #[payload]" category="${app.log.category}" />
		<logger level="INFO" doc:name="END - Update Dimension" doc:id="b6fd46e4-b008-47ea-990f-220fa0196d25" message="END - Update Dimension | Success | System ID: #[vars.uriParams]" category="${app.log.category}" />
	</sub-flow>
</mule>
