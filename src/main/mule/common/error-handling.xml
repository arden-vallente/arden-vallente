<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd">
	<error-handler name="system-error-handler" doc:id="97062a37-bbd2-41b9-9e2a-652f86a56950" >
		<on-error-propagate enableNotifications="true" logException="false" doc:name="On Error Propagate" doc:id="47a10fce-ab61-4928-a945-ade90b4fbd2c" type="HTTP:CONNECTIVITY, HTTP:SECURITY, HTTP:TIMEOUT">
			<logger level="ERROR" doc:name="Log System Connectivity ERROR" doc:id="94c49042-9c86-47e7-8122-55886a3b2db9" message="ERROR - CONNECTIVITY: #[error.description] | #[error.errorMessage.payload]" category="${app.log.category.error}" />
		</on-error-propagate>
		<on-error-continue enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="4d9c7df0-4b27-4341-a8ee-989c74ea6633" type="ANY" >
			<logger level="ERROR" doc:name="Log System Other ERROR" doc:id="76984e71-cf6e-4396-b2ca-1dc8b1997212" message="ERROR - Exception: #[error.description] | #[error.errorMessage.payload]" category="${app.log.category.error}" />
			<set-variable value="#[true]" doc:name="Set hasError" doc:id="e1670ac4-d111-4c9c-8781-fa4e9f34dd18" variableName="hasError"/>
		</on-error-continue>
	</error-handler>
	<error-handler name="default-error-handler" doc:id="ea1d628c-7516-4ba0-b07d-acb7ecca68a3" >
		<on-error-continue enableNotifications="true" logException="true" doc:name="On Error Continue" doc:id="ebac653e-f687-41a1-8f59-1d42b4a374a3" type="ANY">
			<logger level="ERROR" doc:name="Error Response, httpStatus based on the error" doc:id="a9d63c37-a89d-4dbb-961a-e0ee5b6bdf7b" message="ERROR - Default Exception: #[error.description] | #[error.errorMessage.payload]" category="${app.log.category.error}"/>
		</on-error-continue>
	</error-handler>
	<sub-flow name="error-handling-validate-errors" doc:id="1905415c-1276-41a3-bb8b-72e001be4de4" >
		<choice doc:name="if hasError?" doc:id="ec664ee7-3737-43bf-9d7d-f35ea2db54d1" >
			<when expression="#[(!isEmpty(vars.hasError))]">
				<raise-error doc:name="Raise System error" doc:id="96157928-bd7c-40d3-b907-93c90f3ceb84" type="FS:SYSTEM_ERROR"/>
			</when>
		</choice>
	</sub-flow>
	</mule>
